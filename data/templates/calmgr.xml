<?xml version="1.0" encoding="UTF-8" ?>
<calibration_associations xmlns="http://www.gemini.edu/xml/gsaCalibrations/v1.0">
<!-- Generated by {{ machine_name }} for {{ req_method }} request at {{ now }} / {{ utcnow }} UTC-->
{%- for data in generator %}
 <dataset>
  <datalabel>{{ data.label }}</datalabel>
 {%- if data.filename %}
  <filename>{{ data.filename }}</filename>
  <md5>{{ data.md5 }}</md5>
 {%- endif %}
 {%- for result in data.cal_info %}
 {%- if result.error == True %}
  <!-- PROBLEM WHILE SEARCHING FOR caltype {{ result.type }} -->
 {%- else %}
  {%- for cal in result.cals %}
  <calibration>
    <caltype>{{ result.type }}</caltype>
    <datalabel>{{ cal.label }}</datalabel>
    <filename>{{ cal.name }}</filename>
    <md5>{{ cal.md5 }}</md5>
    {%- if cal.url == None %}
    <!-- Calibration Result found in DB, but file is not present on FITS server -->
    {%- else %}
    <url>{{ cal.url }}</url>
    {%- endif %}
  </calibration>
  {%- else %}
  <!-- NO CALIBRATION FOUND for caltype {{ result.type }} -->
  {%- endfor %}{# for cal in cals #}
 {%- endif %}
 {%- else %}
 <!-- COULD NOT LOCATE METADATA FOR DATASET -->
 {%- endfor %}{# for ct, cals in data.cal_info #}
 </dataset>
{%- endfor %}
</calibration_associations>
